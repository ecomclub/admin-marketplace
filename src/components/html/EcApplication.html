<div class="ec-application">
  <div
    class="row d-flex justify-content-around"
    v-if="isLoaded"
  >
    <div class="col-sm-3">
      <div class="card">
        <img
          v-if="icon"
          :src="icon"
          class="card-img-top"
        />
        <div
          v-else
          :style="{
            background: randomColors,
            fontSize: '4rem'
          }"
          class="card-img-top text-center text-white py-5"
        >
          {{ title.charAt(0) }}
        </div>

        <div class="card-body">
          <div class="text-center mb-3">
            <h3>{{ title }}</h3>
            <p class="card-text">
              {{ shortDescription }}
            </p>

            <button
              class="btn btn-success"
              type="button"
              @click="installApp"
              v-if="!isInstalled"
            >
              <i class="fas fa-plus mr-1"></i>
              {{ i19install }}
            </button>

            <template v-else>
              <button
                class="btn btn-danger"
                id="uninstall-app"
              >
                <i class="fas fa-trash mr-1"></i>
                {{ i19uninstall }}
              </button>

              <b-popover
                target="uninstall-app"
                triggers="click"
                placement="top"
                :show.sync="isPopoverShown"
              >
                {{ i19doYouWantToDeleteAppQn }}
                <div class="text-right py-2">
                  <button
                    class="btn btn-light btn-sm mr-2"
                    type="button"
                    @click="isPopoverShown = false"
                  >
                    {{ i19no }}
                  </button>
                  <button
                    class="btn btn-danger btn-sm"
                    type="button"
                    @click="uninstallApp"
                  >
                    {{ i19yes }}
                  </button>
                </div>
              </b-popover>
            </template>
            <br>
            <small>{{ price }}</small>
          </div>

          <div v-if="author">
            <i class="fas fa-user mr-1"></i>
            {{ i19author }}: {{ author }}
          </div>
          <div v-if="version">
            <i class="fas fa-sync-alt mr-1"></i>
            {{ i19version }}:
            <samp>{{ version }}</samp>
          </div>
          <a
            v-if="website"
            :href="website"
            target="_blank"
          >
            <i class="fas fa-globe mr-1"></i>
            Website
          </a>
        </div>
      </div>
    </div>

    <div class="col-sm-9">
      <div class="card">
        <ul
          class="nav nav-tabs px-3"
          v-model="activeTabKey"
        >
          <li
            v-for="(tab, key) in tabListNoTitle"
            class="nav-item"
          >
            <a
              class="nav-link"
              :class="{ active: activeTabKey === tab.key }"
              role="button"
              @click="activeTabKey = tab.key"
            >
              {{ tab.tab }}
            </a>
          </li>
        </ul>

        <div class="card-body">
          <article
            v-if="activeTabKey === 'description'"
            key="app-description"
            class="px-lg-2"
          >
            <vue-markdown>
              {{ (description || `# ${title}\nApp ID: \`${appId}\``) }}
            </vue-markdown>
          </article>

          <article
            v-else-if="activeTabKey === 'configuration'"
            key="app-settings"
          >
            <slot name="settings">
              <ec-admin-settings-form
                :application="applicationBody"
                @submit="editApp"
              />
              <slot name="settings-append"/>
            </slot>
          </article>

          <article
            v-else-if="activeTabKey === 'relatedApps'"
            key="app-related"
          >
            <div
              v-if="appsRelated.length"
              class="row"
            >
              <div
                class="col-6 col-md-4" v-for="(app, i) in appsRelated"
                :key="`app-${i}`"
              >
                <ec-app-card
                  :app.sync="appsRelated[i]"
                  :ecomApps="ecomApps"
                  @click="$emit('click:app', app)"
                  class="border"
                />
              </div>
            </div>

            <div
              v-else-if="isfetchingRelated"
              class="d-flex justify-content-center my-5"
            >
              <div
                class="spinner-grow"
                style="width: 40px; height: 40px"
                role="status"
              >
                <span class="sr-only">Loading...</span>
              </div>
            </div>

            <p
              v-else
              class="lead"
            >
              {{ i19noAppsAvailable }}
            </p>
          </article>
        </div>
      </div>

      <button
        @click="$emit('click:back')"
        role="button"
        class="float-right btn btn-light"
      >
        <i class="fas fa-undo mr-1"></i>
        {{ i19back }}
      </button>
    </div>
  </div>

  <div
    v-else
    class="d-flex justify-content-center my-5"
  >
    <div
      class="spinner-border"
      style="width: 60px; height: 60px;"
      role="status"
    >
      <span class="sr-only">Loading...</span>
    </div>
  </div>
</div>
